<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>上海地铁线路图</title>
    <style>
        #map {
            width: 100%;
            height: 600px; /* 确保地图容器有高度 */
        }
    </style>
</head>
<body>
    <div id="map"></div>

    <!-- 引入高德地图JS API -->
    <script src="https://webapi.amap.com/maps?v=2.0&key=1931f28b0c029fab895769281d97a27e"></script>
    <script>
        // 初始化地图
        var map = new AMap.Map('map', {
            zoom: 11,
            center: [121.4737, 31.2304] // 上海中心坐标
        });

        // 请求地铁线路数据
        fetch('https://restapi.amap.com/v3/metro/lines?key=1931f28b0c029fab895769281d97a27e&city=上海')
            .then(response => response.json())
            .then(data => {
                if (data.status === '1' && data.lines) {
                    data.lines.forEach(line => {
                        // 解析线路路径
                        var path = line.polyline.split(';').map(point => {
                            var [lng, lat] = point.split(',');
                            return [parseFloat(lng), parseFloat(lat)];
                        });

                        // 绘制地铁线路
                        var polyline = new AMap.Polyline({
                            path: path,
                            strokeColor: line.color || '#0066ff', // 默认颜色
                            strokeWeight: 4,
                            map: map
                        });

                        // 绘制地铁站点
                        line.stations.forEach(station => {
                            var marker = new AMap.Marker({
                                position: [parseFloat(station.location.split(',')[0]), parseFloat(station.location.split(',')[1])],
                                title: station.name,
                                map: map
                            });
                        });
                    });
                } else {
                    console.error('获取地铁线路数据失败:', data);
                }
            })
            .catch(error => {
                console.error('请求地铁线路数据出错:', error);
            });
    </script>
</body>
</html>